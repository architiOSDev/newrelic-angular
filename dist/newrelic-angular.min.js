"use strict";angular.module("newrelic-angular",["angulartics","angulartics.newrelic.insights","newrelic-angular.decorator.log","newrelic-angular.interceptor.http"]),function(t){function e(t){t.decorator("$log",n)}function n(e,n){function a(a){var i=function(){if(t.isDefined(n.newrelic))for(var i,o=0,s=arguments.length;s>o;o++)i=arguments[o],i instanceof Error==!1&&(i=r(i)),n.newrelic.noticeError(i);else e.warn("Could not report error to New Relic because the global New Relic module is missing!");a.apply(null,arguments)};return i.logs=[],i}return e.error=a(e.error),e}function r(t){try{throw new Error(t)}catch(e){return e}}t.module("newrelic-angular.decorator.log",[]).config(e),e.$inject=["$provide"],n.$inject=["$delegate","$window"]}(window.angular),function(t){function e(){function t(t){r=t||[]}function e(t){return t&&isFinite(t)&&r.indexOf(t)>-1}function n(t,n){function r(r,a){var i=a.config||{};if(!e(a.status)){var o="bad "+i.method+" "+r+" "+a.config.url;n.error(new Error(o))}return t.reject(a)}return{requestError:r.bind(null,"request"),responseError:r.bind(null,"response")}}var r=[];this.setStatusesToIgnore=t,this.$get=["$q","$log",n]}function n(t){t.interceptors.push("httpInterceptor")}t.module("newrelic-angular.interceptor.http",[]).provider("httpInterceptor",e).config(n),n.$inject=["$httpProvider"]}(window.angular),function(t,e){var n=window.angulartics||(window.angulartics={});n.waitForVendorCount=0,n.waitForVendorApi=function(t,e,r,a,i){i||n.waitForVendorCount++,a||(a=r,r=void 0),!Object.prototype.hasOwnProperty.call(window,t)||void 0!==r&&void 0===window[t][r]?setTimeout(function(){n.waitForVendorApi(t,e,r,a,!0)},e):(n.waitForVendorCount--,a(window[t]))},t.module("angulartics",[]).provider("$analytics",function(){var e={pageTracking:{autoTrackFirstPage:!0,autoTrackVirtualPages:!0,trackRelativePath:!1,autoBasePath:!1,basePath:""},eventTracking:{},bufferFlushDelay:1e3,developerMode:!1},r=["pageTrack","eventTrack","setAlias","setUsername","setUserProperties","setUserPropertiesOnce","setSuperProperties","setSuperPropertiesOnce"],a={},i={},o=function(t){return function(){n.waitForVendorCount&&(a[t]||(a[t]=[]),a[t].push(arguments))}},s=function(e,n){return i[e]||(i[e]=[]),i[e].push(n),function(){var n=arguments;t.forEach(i[e],function(t){t.apply(this,n)},this)}},u={settings:e},c=function(t,e){e?setTimeout(t,e):t()},g={$get:function(){return u},api:u,settings:e,virtualPageviews:function(t){this.settings.pageTracking.autoTrackVirtualPages=t},firstPageview:function(t){this.settings.pageTracking.autoTrackFirstPage=t},withBase:function(e){this.settings.pageTracking.basePath=e?t.element(document).find("base").attr("href"):""},withAutoBase:function(t){this.settings.pageTracking.autoBasePath=t},developerMode:function(t){this.settings.developerMode=t}},l=function(n,r){u[n]=s(n,r);var i=e[n],o=i?i.bufferFlushDelay:null,g=null!==o?o:e.bufferFlushDelay;t.forEach(a[n],function(t,e){c(function(){r.apply(this,t)},e*g)})},f=function(t){return t.replace(/^./,function(t){return t.toUpperCase()})},p=function(t){var e="register"+f(t);g[e]=function(e){l(t,e)},u[t]=s(t,o(t))};return t.forEach(r,p),g}).run(["$rootScope","$window","$analytics","$injector",function(e,n,r,a){r.settings.pageTracking.autoTrackFirstPage&&a.invoke(["$location",function(t){var e=!0;if(a.has("$route")){var i=a.get("$route");for(var o in i.routes){e=!1;break}}else if(a.has("$state")){var s=a.get("$state");for(var u in s.get()){e=!1;break}}if(e)if(r.settings.pageTracking.autoBasePath&&(r.settings.pageTracking.basePath=n.location.pathname),r.settings.pageTracking.trackRelativePath){var c=r.settings.pageTracking.basePath+t.url();r.pageTrack(c,t)}else r.pageTrack(t.absUrl(),t)}]),r.settings.pageTracking.autoTrackVirtualPages&&a.invoke(["$location",function(t){r.settings.pageTracking.autoBasePath&&(r.settings.pageTracking.basePath=n.location.pathname+"#"),a.has("$route")&&e.$on("$routeChangeSuccess",function(e,n){if(!n||!(n.$$route||n).redirectTo){var a=r.settings.pageTracking.basePath+t.url();r.pageTrack(a,t)}}),a.has("$state")&&e.$on("$stateChangeSuccess",function(e,n){var a=r.settings.pageTracking.basePath+t.url();r.pageTrack(a,t)})}]),r.settings.developerMode&&t.forEach(r,function(t,e){"function"==typeof t&&(r[e]=function(){})})}]).directive("analyticsOn",["$analytics",function(e){function n(t){return["a:","button:","button:button","button:submit","input:button","input:submit"].indexOf(t.tagName.toLowerCase()+":"+(t.type||""))>=0}function r(t){return n(t),"click"}function a(t){return n(t)?t.innerText||t.value:t.id||t.name||t.tagName}function i(t){return"analytics"===t.substr(0,9)&&-1===["On","Event","If","Properties","EventType"].indexOf(t.substr(9))}function o(t){var e=t.slice(9);return"undefined"!=typeof e&&null!==e&&e.length>0?e.substring(0,1).toLowerCase()+e.substring(1):e}return{restrict:"A",link:function(n,s,u){var c=u.analyticsOn||r(s[0]),g={};t.forEach(u.$attr,function(t,e){i(e)&&(g[o(e)]=u[e],u.$observe(e,function(t){g[o(e)]=t}))}),t.element(s[0]).bind(c,function(r){var i=u.analyticsEvent||a(s[0]);g.eventType=r.type,(!u.analyticsIf||n.$eval(u.analyticsIf))&&(u.analyticsProperties&&t.extend(g,n.$eval(u.analyticsProperties)),e.eventTrack(i,g))})}}}])}(angular),function(t){t.module("angulartics.newrelic.insights",["angulartics"]).config(["$analyticsProvider",function(e){angulartics.waitForVendorApi("newrelic",100,function(n){e.registerEventTrack(function(t,e){n.addPageAction(t,e)}),e.registerSetUsername(function(t){n.setCustomAttribute("username",t)}),e.registerSetAlias(function(t){n.setCustomAttribute("alias",t)}),e.registerSetUserProperties(function(e){t.forEach(e,function(t,e){n.setCustomAttribute(e,t)})})})}])}(angular);